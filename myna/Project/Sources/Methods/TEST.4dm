//%attributes = {}
$pin4:=Folder:C1567(fk home folder:K87:24).file("pin4").getText()
$pin6:=Folder:C1567(fk home folder:K87:24).file("pin6").getText()

var $myna : cs:C1710.myna
$myna:=cs:C1710.myna.new()

//$version:=$myna.version()
//$mynumber:=$myna.text_mynumber($pin4)
//$photo:=$myna.visual_photo($pin4)
//SET PICTURE TO PASTEBOARD($photo)
//$attr:=$myna.text_attr($pin4)
//$status:=$myna.pin_status()
//$info:=$myna.text_info()
//$test:=$myna.test()
//$signature:=$myna.text_signature($pin4)
//$cert:=$myna.text_cert($pin4)
//$auth:=$myna.jpki_cert_auth()
//$sign:=$myna.jpki_cert_sign($pin6)

$sign:=$myna.jpki_cms_sign("abcde"; $pin6)
var $hash : Text
BASE64 ENCODE:C895($sign; $hash)
SET TEXT TO PASTEBOARD:C523($hash)
/*
MIIJSAYJKoZIhvcNAQcCoIIJOTCCCTUCAQExDTALBglghkg
BZQMEAgEwFAYJKoZIhvcNAQcBoAcEBWFiY2RloIIG4zCCBt
8wggXHoAMCAQICBAHvlwswDQYJKoZIhvcNAQELBQAwgYAxC
zAJBgNVBAYTAkpQMQ0wCwYDVQQKDARKUEtJMSMwIQYDVQQL
DBpKUEtJIGZvciBkaWdpdGFsIHNpZ25hdHVyZTE9MDsGA1U
ECww0SmFwYW4gQWdlbmN5IGZvciBMb2NhbCBBdXRob3JpdH
kgSW5mb3JtYXRpb24gU3lzdGVtczAeFw0yMDA5MTEwNDQ2M
DRaFw0yNTA5MjIxNDU5NTlaMF0xCzAJBgNVBAYTAkpQMREw
DwYDVQQHDAhUb2t5by10bzEUMBIGA1UEBwwLU2V0YWdheWE
ta3UxJTAjBgNVBAMMHDIwMjAwOTExMTM0NjIwMDAwMDAxMz
ExMjA0MUIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKA
oIBAQDJf59bDIEW34GdV/B5H7V6Gr4q8L1l5gBgkU3lQPfk
KHdPqx/ZZrRKa0pGQxDeQY0Q0JIuk2EKM0gs/BLJnBM8sjT
htf9N1G5bs7U0ls+6TbNtyIW7Pu3N2zYRv4ff7mcKAA+yRW
4sBGls/uAhOo49MHn1I+FHXSY0NyNVubqa6AGOE1pXP2NqL
RkmKJ00F63NaxPRQKgaeJGSKnSxdjoOzLRPRcq5ADgjCR6U
mZcq1SMF+uB2azbmu3f4W24da9vxw5UbyjgipQZOLTpUSkn
Eu8xtmQeuqLwxAMXLtJTZ4cAyX/XcGlfklKXaw4UpkDZMdS
0ZEIO2MoPpBD1w9xM3AgMBAAGjggOBMIIDfTAOBgNVHQ8BA
f8EBAMCBsAwge0GA1UdEQSB5TCB4qAfBgoqgwiMm1UIBQUB
oBEMD+WuruWPpOOAgOWVk+S7i6AZBgoqgwiMm1UIBQUEoAs
MCTMxOTc0MDkyMqARBgoqgwiMm1UIBQUDoAMMATGgUgYKKo
MIjJtVCAUFBaBEDELmnbHkuqzpg73kuJbnlLDosLfljLrml
rDnlLrvvJHkuIHnm67vvJLvvJHnlarvvJHvvJHvvI3vvJjv
vJDvvJTlj7egFQYKKoMIjJtVCAUFAqAHDAUwMDAwMKAmBgo
qgwiMm1UIBQUGoBgMFjAwMDAwMDAwMDAwMDAwMDAwMDAwMD
AwSQYDVR0gAQH/BD8wPTA7BgsqgwiMm1UIBQEBFDAsMCoGC
CsGAQUFBwIBFh5odHRwOi8vd3d3Lmpwa2kuZ28uanAvY3Bz
Lmh0bWwwga4GA1UdEgSBpjCBo6SBoDCBnTELMAkGA1UEBhM
CSlAxJzAlBgNVBAoMHuWFrOeahOWAi+S6uuiqjeiovOOCte
ODvOODk+OCuTEwMC4GA1UECwwn5YWs55qE5YCL5Lq66KqN6
Ki844K144O844OT44K5572y5ZCN55SoMTMwMQYDVQQLDCrl
nLDmlrnlhazlhbHlm6PkvZPmg4XloLHjgrfjgrnjg4bjg6D
mqZ/mp4swgawGA1UdHwSBpDCBoTCBnqCBm6CBmKSBlTCBkj
ELMAkGA1UEBhMCSlAxDTALBgNVBAoMBEpQS0kxIzAhBgNVB
AsMGkpQS0kgZm9yIGRpZ2l0YWwgc2lnbmF0dXJlMSAwHgYD
VQQLDBdDUkwgRGlzdHJpYnV0aW9uIFBvaW50czERMA8GA1U
ECwwIVG9reW8tdG8xGjAYBgNVBAMMEVNldGFnYXlhLWt1IE
NSTERQMIGwBgNVHSMEgagwgaWAFE3gF95Lf0c9zYZ6YtOLE
0rOg1WKoYGGpIGDMIGAMQswCQYDVQQGEwJKUDENMAsGA1UE
CgwESlBLSTEjMCEGA1UECwwaSlBLSSBmb3IgZGlnaXRhbCB
zaWduYXR1cmUxPTA7BgNVBAsMNEphcGFuIEFnZW5jeSBmb3
IgTG9jYWwgQXV0aG9yaXR5IEluZm9ybWF0aW9uIFN5c3Rlb
XOCBAEyxKswHQYDVR0OBBYEFKHUbYMSz843arnCAFaHI5TM
G4bTMA0GCSqGSIb3DQEBCwUAA4IBAQBhftYHEuhKAtfa6l+
PRETv7tGFc9raQPHbTi3iRftx/cvnWqPexZ6jADlhodvjK5
MZLnABK7EyWPopsbQuegUs3oMnB1I7ub3sWPMNm2TjaA6Zo
KR1pS1Km0uTSqXOCFJG7IIo5Uer0oig+OXdH9IvgfQfMJGc
MYxr5nkfC/eVZTIQKr2tJrEvtPBKDqrQiXzLRNGfo7oZpuo
HJjNV6pKkxvc+B9XfrS0TCCS2AvPjFNhkAsyWrIueefzVwL
Gg9wL3XVAJ2mwDSZW3lRGtoAPixdgyqrLIdYhK44wqcwY/U
NgZm5RcmFn+3ZaP4x3zJ4pX6qgJJlDURtH3WrudgMtQMYIC
IjCCAh4CAQEwgYkwgYAxCzAJBgNVBAYTAkpQMQ0wCwYDVQQ
KDARKUEtJMSMwIQYDVQQLDBpKUEtJIGZvciBkaWdpdGFsIH
NpZ25hdHVyZTE9MDsGA1UECww0SmFwYW4gQWdlbmN5IGZvc
iBMb2NhbCBBdXRob3JpdHkgSW5mb3JtYXRpb24gU3lzdGVt
cwIEAe+XCzALBglghkgBZQMEAgGgbTAYBgkqhkiG9w0BCQM
xCwYJKoZIhvcNAQcBMCAGCSqGSIb3DQEJBTETFxEyNDEyMD
QyMDQwMjIrMDkwMDAvBgkqhkiG9w0BCQQxIgQgNrvlDtloQ
dEEQ7y2cNZVTwo0t2G+Z+ycSorSwMRMpCwwCwYJKoZIhvcN
AQELBIIBAJ3b1A3RnSLYuNPPjo+BBPmJ4/16SC+1wlOXz6r
c4XTnCbpFAZChSEgwazzEsFNMX3JiE13UVc+xbRn2URKIOm
IOU7GPMESf3OrDXGXjon+QumQIe2OmlO9W+enSncU/ycYfQ
mdfCRgGniXZ4eV64UUvomfwBA7lUC07WGLJdrmOdjvk7ul4
p4fCQvjzPkU8bhS/3lkAYdX3+MLYYCauoI/KhhFH++3RlwV
kCNlyta7iQ+HsysduYchrc4hLUvx2WV99QWYJZEWhbKtoUU
T6rts1/WFMB9d/1CRQ6ldfS9O/0Yz307pfay8Q7nKFMumLm
1IApMNqndINhbsRNS0pReShAA==
*/

/*
pkcs7: cannot convert encryption algorithm to oid, unknown private key type libmyna.JPKISignSigner
*/